# 수익화 및 기능 확장 계획 (Monetization Plan)

## 1. 개요
이 문서는 GPS 추억 자물쇠 앱의 수익화 모델과 이를 지원하기 위한 기술적 구현 계획을 기술합니다. 주요 수익원은 **구독 모델(Freemium)**, **인앱 결제(고급 자물쇠)**, 그리고 **광고**입니다.

## 2. 수익화 모델 (Business Models)

### A. 구독 모델 (Premium Subscription)
사용자를 '무료(Free)'와 '프리미엄(Premium)' 등급으로 구분합니다.
*   **무료 사용자:**
    *   월간 자물쇠 생성 개수 제한 (예: 월 3개).
    *   '친한 친구' 등록 수 제한 (예: 최대 5명).
*   **프리미엄 사용자 (월 구독):**
    *   자물쇠 생성 무제한.
    *   친구 등록 무제한.
    *   기본 제공되는 '고급 자물쇠' 스킨 일부 무료 사용 가능.

### B. 인앱 결제 (Premium Locks - 고급 자물쇠)
단건 구매 가능한 특별한 아이템입니다. 구독자가 아니더라도 개별 구매가 가능합니다.
*   **고급 자물쇠 특징:**
    *   **시각적 차별화:** 지도 상에서 황금색, 반짝임 효과, 3D 아이콘 등 눈에 띄는 디자인.
    *   **기능적 혜택:**
        *   **알림 반경 확대:** 일반 자물쇠보다 더 넓은 범위(예: 100m -> 300m)에 진입해도 알림 발송.
        *   **우선 노출:** 친구의 지도에서 내 자물쇠가 더 상위에 표시되거나 강조됨.
        *   **영구 보존:** (옵션) 서버 데이터 정리 시에도 영구적으로 보존됨을 보장.

---

## 3. 기술적 구현 계획 (Technical Implementation)

### A. 데이터베이스 설계 변경 (Supabase)
기존 테이블 구조에 수익화 관련 필드를 추가해야 합니다.

1.  **`app_users` 테이블 (사용자 정보)**
    *   `subscription_plan`: `text` (default: 'free') - 'free' 또는 'premium'.
    *   `credits`: `integer` (default: 0) - 고급 자물쇠 구매를 위한 인앱 재화(코인 등).

2.  **`memories` (또는 `locks`) 테이블 (자물쇠 정보)**
    *   `lock_type`: `text` (default: 'standard') - 'standard', 'gold', 'diamond' 등.
    *   `skin_id`: `text` - 적용된 스킨 ID.

3.  **`user_inventory` 테이블 (신규)**
    *   사용자가 구매한 자물쇠 스킨이나 아이템을 관리.
    *   `user_id`, `item_id`, `quantity`, `purchased_at`.

### B. UI/UX 변경 사항 (`index_new.html`, `style.css`)

1.  **상점(Store) 페이지 추가**
    *   프리미엄 구독 결제 버튼.
    *   고급 자물쇠 스킨 미리보기 및 구매 버튼.
2.  **자물쇠 만들기 화면 (`editModal`) 개선**
    *   자물쇠 종류 선택 옵션 (일반 vs 고급).
    *   고급 선택 시 미리보기 및 보유 개수 확인/구매 유도.
3.  **지도 화면 (`mainMap`) 개선**
    *   `lock_type`에 따라 마커 아이콘(Leaflet Marker) 이미지를 다르게 렌더링.
    *   고급 자물쇠는 CSS 애니메이션(반짝임 등) 추가.

### C. 로직 구현 (`script.js`)

1.  **권한 체크 (Permission Check)**
    *   `saveLock()` 호출 시:
        *   무료 유저의 경우 이번 달 생성 개수 확인 -> 초과 시 결제 유도 팝업.
        *   고급 자물쇠 선택 시 -> 인벤토리 확인 또는 결제 모듈 호출.
2.  **결제 연동 (Payment Integration)**
    *   PG사(토스 페이먼츠, Stripe 등) 연동을 위한 결제 요청 함수 구현.
    *   결제 성공 시 Supabase 데이터 업데이트 (구독 상태 변경 또는 아이템 지급).

---

## 4. 개발 로드맵 (Roadmap)

1.  **1단계: DB 스키마 업데이트 및 더미 데이터 테스트**
    *   Supabase 테이블 컬럼 추가.
    *   고급 자물쇠 데이터 수동 입력 후 지도 표시 테스트.
2.  **2단계: UI 구현 (상점 및 자물쇠 선택)**
    *   자물쇠 생성 화면에 디자인 선택 UI 추가.
    *   상점 모달창 퍼블리싱.
3.  **3단계: 제한 로직 적용**
    *   무료 유저 제한 기능 구현.
4.  **4단계: 결제 모듈 연동 (최종)**
    *   실제 결제 테스트 및 연동.

## 5. 웹 테스트 환경

현재 앱은 웹 브라우저에서 직접 테스트 가능합니다:
*   `index_new.html` 파일을 브라우저에서 열기
*   로컬 서버 실행: `python -m http.server 8000` 또는 Live Server 사용
*   GPS 권한이 필요하므로 HTTPS 환경 권장 (또는 localhost)
